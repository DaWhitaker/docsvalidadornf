{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Validador de notas fiscais","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o da ferramenta de confer\u00eancia de notas fiscais. Desenvolvida com o intuito de simplificar e agilizar o processo de valida\u00e7\u00e3o de notas fiscais,  oferecendo uma solu\u00e7\u00e3o intuitiva.</p> <p>Nesta documenta\u00e7\u00e3o, voc\u00ea encontrar\u00e1 uma vis\u00e3o das funcionalidades, desde uma descri\u00e7\u00e3o geral at\u00e9 informa\u00e7\u00f5es espec\u00edficas.Al\u00e9m disso, apresentamos as etapas para instala\u00e7\u00e3o e uso.</p> <p>Sinta-se \u00e0 vontade para explorar os diferentes t\u00f3picos na barra de navega\u00e7\u00e3o \u00e0 esquerda e descubra como a ferramenta pode simplificar a tarefa de confer\u00eancia de notas fiscais, trazendo efici\u00eancia e praticidade.</p>"},{"location":"arquitetura/","title":"Arquitetura","text":"<p>O Validador de Arquivos - TAX \u00e9 desenvolvido em Python e segue uma arquitetura baseada em classes e interface gr\u00e1fica usando a biblioteca Tkinter.</p> <p>A estrutura principal do c\u00f3digo inclui: - Classe <code>ProcessadorDados</code>: Respons\u00e1vel pelo processamento e valida\u00e7\u00e3o de arquivos fiscais. - Outras classes e fun\u00e7\u00f5es auxiliares para manipula\u00e7\u00e3o de arquivos, GUI, etc.</p> <p>O c\u00f3digo segue o paradigma de programa\u00e7\u00e3o orientada a objetos, onde as diferentes funcionalidades s\u00e3o encapsuladas em classes, tornando o c\u00f3digo modular e f\u00e1cil de manter.</p>"},{"location":"classe-processadordados/","title":"Classe <code>ProcessadorDados</code>","text":"<p>A classe <code>ProcessadorDados</code> \u00e9 respons\u00e1vel pelo processamento e valida\u00e7\u00e3o de arquivos fiscais no aplicativo Validador de Arquivos - TAX. Aqui est\u00e1 uma vis\u00e3o geral dos principais m\u00e9todos e atributos:</p>"},{"location":"classe-processadordados/#metodos","title":"M\u00e9todos:","text":"<ul> <li><code>__init__(self, janela)</code>: M\u00e9todo de inicializa\u00e7\u00e3o da classe, recebe a janela principal como argumento.</li> <li><code>toggle_botoes()</code>: M\u00e9todo para alternar a habilita\u00e7\u00e3o de bot\u00f5es com base nas op\u00e7\u00f5es selecionadas.</li> <li>M\u00e9todos de sele\u00e7\u00e3o de arquivos para diferentes tipos de valida\u00e7\u00e3o (ICMS, IPI, PIS, COFINS, etc.).</li> <li>M\u00e9todos para execu\u00e7\u00e3o do processo de valida\u00e7\u00e3o e exporta\u00e7\u00e3o de relat\u00f3rios.</li> </ul>"},{"location":"classe-processadordados/#atributos","title":"Atributos:","text":"<ul> <li><code>janela</code>: Refer\u00eancia \u00e0 janela principal da aplica\u00e7\u00e3o.</li> <li>Atributos para armazenar caminhos de entrada e sa\u00edda de arquivos.</li> <li>Atributos relacionados ao controle de tempo para monitorar o desempenho das opera\u00e7\u00f5es.</li> </ul> <p>Esta classe \u00e9 central para o funcionamento do aplicativo e encapsula a l\u00f3gica de processamento de dados.</p>"},{"location":"como-usar/","title":"Como Usar","text":"<p>Para usar o Validador de Arquivos - TAX, siga estas instru\u00e7\u00f5es:</p> <ol> <li> <p>Abra o aplicativo ap\u00f3s a instala\u00e7\u00e3o.</p> </li> <li> <p>Selecione os arquivos fiscais que deseja processar.</p> <ul> <li>Os arquivos dever\u00e3o obrigat\u00f3riamente estar no format .CSV.</li> </ul> <p></p> </li> <li> <p>Escolha as op\u00e7\u00f5es de valida\u00e7\u00e3o (ICMS, IPI, PIS, COFINS, etc.).</p> <ul> <li>Poder\u00e1 ser selecionado apenas um dos processos ou ambos ao mesmo tempo.</li> <li>Na exporta\u00e7\u00e3o tamb\u00e9m, mesmo executando ambos os processos, poder\u00e1 ser exportado apenas o que desejar, bastando retirar a sele\u00e7\u00e3o do processo que n\u00e3o deseja exportar.</li> </ul> <p></p> </li> <li> <p>Execute o processo de valida\u00e7\u00e3o.</p> <p></p> </li> <li> <p>Exporte os relat\u00f3rios gerados, se necess\u00e1rio.</p> <ul> <li>O nome do arquivo exportado ser\u00e1 o seguinte:<ul> <li>Arquivo ICMS - IPI total: <code>ICMS_Completo + Data + Hora + Minuto + Segundo</code></li> <li>Arquivo ICMS - IPI Inconsit\u00eancias: <code>ICMS_Inconsist + Data + Hora + Minuto + Segundo</code></li> <li>Arquivo PIS - COFINS total: <code>PIS_Completo + Data + Hora + Minuto + Segundo</code></li> <li>Arquivo PIS - COFINS Inconsit\u00eancias: <code>PIS_Inconsist + Data + Hora + Minuto + Segundo</code></li> </ul> </li> </ul> <p></p> </li> </ol> <p>A interface gr\u00e1fica fornece feedback em tempo real sobre o progresso das opera\u00e7\u00f5es e quaisquer mensagens de erro que possam ocorrer.</p>"},{"location":"funcionalidades/","title":"Funcionalidades","text":"<p>A ferramenta de confer\u00eancia de notas oferece as seguintes funcionalidades:</p> <ol> <li> <p>Sele\u00e7\u00e3o de arquivos fiscais para processamento. </p> </li> <li> <p>Validar e processar arquivos de notas fiscais para ICMS, IPI, PIS, COFINS.</p> </li> <li> <p>Exportar relat\u00f3rios de totaliza\u00e7\u00e3o e inconsist\u00eancias para an\u00e1lise posterior.</p> </li> <li>Interface gr\u00e1fica intuitiva para facilitar o uso do aplicativo.</li> <li>Controle de tempo para monitorar o desempenho das opera\u00e7\u00f5es.</li> </ol>"},{"location":"instalacao/","title":"Instala\u00e7\u00e3o","text":"<p>Para instalar e configurar a ferramenta de confer\u00eancia de notas fiscais, siga estas etapas:</p> <ol> <li> <p>Baixar arquivo instalador que est\u00e1 dipon\u00edvel neste endere\u00e7o https://ui.sharepoint.com/sites/TaxBrasil/Shared%20Documents/Forms/AllItems.aspx?csf=1&amp;web=1&amp;e=Deecri&amp;ovuser=5e0b361b%2D59ed%2D466e%2D8759%2D030448046197%2Crafael%2Ebueno%40nutrien%2Ecom&amp;cid=3617a4c3%2D0b48%2D4417%2Dadf0%2D9915e6e8a970&amp;FolderCTID=0x01200094B6EB29C2150644818A564DFF77F6A3&amp;id=%2Fsites%2FTaxBrasil%2FShared%20Documents%2FTax%20Transformation%2FConferencias%20Fiscais&amp;viewid=9df8e771%2D51b9%2D456d%2Db388%2D545de31a5f60&amp;OR=Teams%2DHL&amp;CT=1715716321151&amp;clickparams=eyJBcHBOYW1lIjoiVGVhbXMtRGVza3RvcCIsIkFwcFZlcnNpb24iOiI0OS8yNDAzMzEwMTgxNyIsIkhhc0ZlZGVyYXRlZFVzZXIiOmZhbHNlfQ%3D%3D. </p> </li> <li> <p>Fa\u00e7a a extra\u00e7\u00e3o do arquivo <code>.zip</code></p> </li> <li> <p>Salve o arquivo extra\u00eddo no diret\u00f3rio <code>C:\\Users\\seu usu\u00e1rio</code>.</p> </li> <li> <p>Crie um atalho do arquivo <code>.exe</code> em sua \u00e1rea de trabalho.</p> </li> <li> <p>Execute os processos desejados.</p> </li> </ol> <p>Com estas etapas, o aplicativo deve iniciar e voc\u00ea estar\u00e1 pronto para usar a ferramenta de confer\u00eancia de notas fiscais.</p>"},{"location":"outras-classes/","title":"Outras Classes","text":"<p>Al\u00e9m da classe <code>ProcessadorDados</code>, o c\u00f3digo da ferramenta de conf\u00eancia de notas fiscais pode incluir outras classes e fun\u00e7\u00f5es auxiliares para diferentes tarefas. Aqui est\u00e1 uma vis\u00e3o geral das principais classes e m\u00f3dulos:</p> <ul> <li>classes init: Cont\u00e9m m\u00e9todos e atributos relacionados \u00e0 interface gr\u00e1fica do usu\u00e1rio, como cria\u00e7\u00e3o de widgets, gerenciamento de eventos, etc.</li> <li>classes conditional: Respons\u00e1vel por opera\u00e7\u00f5es de leitura, escrita e manipula\u00e7\u00e3o de arquivos, como sele\u00e7\u00e3o de arquivos, valida\u00e7\u00e3o de formatos, etc.</li> <li>classes export: Respons\u00e1vel pela exporta\u00e7\u00e3o dos arquivos.</li> </ul> <p>Cada classe ou m\u00f3dulo \u00e9 projetado para cumprir uma fun\u00e7\u00e3o espec\u00edfica e contribui para a funcionalidade geral do aplicativo.</p>"},{"location":"pre-requisitos/","title":"Pr\u00e9-requisitos","text":"<p>Para executar o Validador de Arquivos - TAX, voc\u00ea precisar\u00e1 dos seguintes pr\u00e9-requisitos:</p> <ul> <li>Python 3.x instalado no sistema.</li> <li>Bibliotecas Python: tkinter, pandas, numpy, pillow (PIL), chardet.</li> <li>Sistema operacional compat\u00edvel com Tkinter (Windows, macOS, Linux).</li> </ul> <p>Certifique-se de ter todas as depend\u00eancias instaladas antes de executar o aplicativo.</p>"},{"location":"regra_icms/","title":"ICMS - IPI","text":"Ordem Nome_Coluna Descritivo da Regra Nutrien Agrichem FCR SGL 1 CST_Isenta Valida se CST 40/41 e valor de ICMS diferente de zero X X X X 2 CST_Outra Valida se CST 50/51/90 e valor de ICMS diferente de zero X X X X 3 CST_Reducao Valida se CST 20 e valor de Isento diferente de zero ou Redu\u00e7\u00e3o igual zero X X X X 4 CST_Tributado Valida se CST 00 tem valor de ICMS igual a zero X X X X 5 CFOP_Industrial Valida as filiais Nutrien de ind\u00fastria se possuem CFOP de com\u00e9rcio X X X X 6 CFOP_Comercio Valida as filiais Nutrien de com\u00e9rcio se possuem CFOP de ind\u00fastria X X X 7 CFOP_SemDestaque_ICMS Valida as opera\u00e7\u00f5es que n\u00e3o devem ter ICMS, por\u00e9m, possuem valor escriturados X X X X 8 CFOP_Com_ICMS Validar as opera\u00e7\u00f5es que devem ter ICMS destacado, por\u00e9m, est\u00e3o com valores zerados X X X X 9 TP_MOV_CFOP Valida se o c\u00f3digo do tipo de movimento (E/S) est\u00e1 correto conforme a opera\u00e7\u00e3o CFOP (E/S) X X X X 10 CFOP_ALIQ_4 CFOPs opera\u00e7\u00f5es interestaduais com CST iniciando (1,2,3,8) e que possuam Aliquota diferente de 4% X X X 11 VLR_Contabil_Analise_ICMS Comparar valor cont\u00e1bil do item com o somat\u00f3rio dos campos Valor ICMS, Redu\u00e7\u00e3o, Isentas, Outras, Desconto X 12 CFOP_Energ_Telecom Realizar o comparativo dos produtos de energia e telecom que possuam CFOP incorreto X X X X 13 UF_CFOP_Operacoes Valida se as opera\u00e7\u00f5es possuem primeiro d\u00edgito do CFOP incorreto: 1 e 5 (Intraestadual), 2 e 6 (Interestadual) X X X X 14 CFOP_CST_90 Valida se as opera\u00e7\u00f5es com CFOPs 1406, 1407, 2406 e 2407 est\u00e3o com CST diferente de 90 X X X X 15 Compra_Brindes Verifica se a descri\u00e7\u00e3o do produto possui palavras chaves, tais como, brinde, kit, camisa, bone, entre outros X X X X 16 Compra_Brindes_Razao_Social Verifica se a raz\u00e3o social possui palavras chaves, tais como, brinde, kit, camisa, bone, entre outros X X X X 17 ISENTO_ICMS Valida se as empresas com IE isento, possui valores de ICMS e/ou Base X X X X 18 CFOP_CST_2101_2102_2201_2202 Valida se os CFOPs 2101, 2102, 2201, 2202 est\u00e3o com CST diferentes de 00 e 20 e com base de ICMS igual a zero X X X X 19 VLR_Contabil_Analise_IPI Comparar valor cont\u00e1bil do item com o somat\u00f3rio dos campos Valor IPI, Redu\u00e7\u00e3o, Isentas, Outras X X X 20 CFOP_Frete_CST_20 Valida se o c\u00f3digo do modelo \u00e9 57 (Frete) e CST igual a 20 X X X X 21 VLR_ICMS_Check Valida se o c\u00e1lculo de base vezes al\u00edquota est\u00e1 diferente do valor informado de ICMS X X X 22 CFOP_Despesa_Cred_Ind Valida se CFOPs com finais 556 e 407 possuem valor de ICMS X X X X 23 ICMS_0_Aliq_Preenchida Verifica casos que possuam al\u00edquota preenchida, por\u00e9m, com valor de ICMS zerado X X 24 VL_IPI_Zerado Indica casos de notas que possuem valores de IPI X X 25 Prod_Rural_Outro Indica se existem casos em que a raz\u00e3o social do produtor rural cont\u00e9m a palavra outros. Espec\u00edfico para SP X X X 26 Aliq_CFOP_Interestadual Indica se as notas com al\u00edquotas 7% e 12% n\u00e3o possuem CFOP iniciando com 2 ou 6 X X X 27 CST_CFOP_1653 Indica as notas que possuem CFOP 1653 e CST diferente de 90 X X X X 28 CFOP_Transf_CST Indica as opera\u00e7\u00f5es com CFOP iguais a 2151, 2152, 6151, 6152 com CST diferentes de 20 e 00 X X X X 29 CST_50_Suspensao_Remessa Verificar as opera\u00e7\u00f5es de remessa que possui CST diferente de 50 X X X X 30 CST_41_NaoTributada_Remessa Verificar as opera\u00e7\u00f5es n\u00e3o tributada e de remessa que possui CST diferente de 41 X X X X 31 CST_40_Isento_Remessa Verificar as opera\u00e7\u00f5es isentas e de remessa que possui CST diferente de 40 X X X X 32 CST_41_Remessa_AG_Conserto Verificar as opera\u00e7\u00f5es de remessa que possui CST diferente de 41 X X X X 33 CST_50_Remessa_Conserto Verificar as opera\u00e7\u00f5es de remessa que possui CST diferente de 50 X X X X 34 CST_90_Remessa_AG Verificar as opera\u00e7\u00f5es de remessa que possui CST diferente de 90 X X X X 35 CFOP_Diferente_Transf Verifica para empresas Nutrien quais notas n\u00e3o possuem CFOP de transfer\u00eancia X X X X 36 Baixa_Estoque Indica notas que possuam CFOP 5927 X X X X 37 CFOP_Uso_Consumo Valida se os produtos sementes, fertilizantes, defensivos foram classificados com CFOP de Uso e Consumo X X X X 38 Chave_Acesso Valida se a estrutura da chave de acesso est\u00e1 condizente com os campos CNPJ, Serie, NF X X X X"},{"location":"regra_pis/","title":"PIS - COFINS","text":"Ordem Nome_Coluna Descritivo da Regra Nutrien Agrichem FCR SGL 1 CST_01_Aliq_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"1\" e a al\u00edquota do PIS \u00e9 diferente de 1,65. X Sem elementos para teste X X 2 CST_01_Aliq_COFINS Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"1\" e a al\u00edquota do PIS \u00e9 diferente de 7,6. X Sem elementos para teste X X 3 CST_01_NCM_Nao_Tributado Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"1\" e os CFOPs come\u00e7am com 5, 6 ou 7 e a al\u00edquota do imposto \u00e9 zero. X Sem elementos para teste X X 5 CST_01_VLR_Contabil_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"1\"  e o valor cont\u00e1bil do PIS \u00e9 diferente do  valor do icms. X Sem elementos para teste X X 7 CST_53_VLR_Contabil_ICMS_IPI_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"53\" e o valor cont\u00e1bil do PIS \u00e9 diferente valor ICMS PIS. X Sem elementos para teste X X 9 CST_53_VLR_Contabil_IPI_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"53\" e o valor cont\u00e1bil do PIS \u00e9 diferente valor IPI PIS. Adionado na regra anterior Sem elementos para teste X X 11 CST_01_VLR_Contabil_COFINS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"1\" e o valor cont\u00e1bil do COFINS \u00e9 diferente valor ICMS. X Sem elementos para teste X X 13 CST_53_VLR_Contabil_ICMS_IPI_COFINS Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e o valor cont\u00e1bil do COFINS \u00e9 diferente valor ICMS COFINS. X Sem elementos para teste X X 15 CST_53_VLR_Contabil_IPI_COFINS Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e o valor cont\u00e1bil do COFINS \u00e9 diferente valor IPI COFINS. Adionado na regra anterior Sem elementos para teste X X 16 CST_06_NCM_Nao_Tributado Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"6\" e os CFOPs come\u00e7am com 5, 6 ou 7 e a al\u00edquota do imposto \u00e9 zero. X Sem elementos para teste X X 17 CST_06_VLR_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"6\" e o valor do PIS \u00e9 diferente de zero. X Sem elementos para teste X X 18 CST_06_VLR_COFINS Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"6\" e o valor do COFINS \u00e9 diferente de zero. X Sem elementos para teste X X 19 CST_08_Ativos Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"8\" e o CFOP \u00e9 diferente de 5551 e 6551. X Sem elementos para teste X X 20 CST_53_Aliq_PIS Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"53\" e a al\u00edquota do PIS \u00e9 deiferente de 1,65. X Sem elementos para teste X X 21 CST_53_Aliq_COFINS Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e a al\u00edquota do COFINS \u00e9 deiferente de 7,6. X Sem elementos para teste X X 22 CST_53_PIS_Valores_Zerados Verifica se a situa\u00e7\u00e3o do PIS \u00e9 \"53\" e valor base PIS \u00e9 igual a zero ou valor do PIS \u00e9 igual a zero. X Sem elementos para teste X X 23 CST_53_COFINS_Valores_Zerados Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e valor base COFINS \u00e9 igual a zero ou valor do COFINS \u00e9 igual a zero. X Sem elementos para teste X X 24 CST_53_CFOP_Servico_Industrializacao Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e CFOPs s\u00e3o 1124, 1125, 2124, 2125. X Sem elementos para teste X X 25 CST_53_CFOP_Energia_Eletrica Verifica se a situa\u00e7\u00e3o do COFINS \u00e9 \"53\" e CFOPs s\u00e3o 1252, 2252, 1253, 2253. X Sem elementos para teste X X"}]}